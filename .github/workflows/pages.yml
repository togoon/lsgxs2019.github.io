name: Deployment
on:
push:
branches: [source] # only push events on source branch trigger deployment
jobs:
hexo-deployment:
runs-on: ubuntu-latest
env:
TZ: Asia/Shanghai
steps:
- name: Checkout source
uses: actions/checkout@v2
- name: Setup Node.js
uses: actions/setup-node@v1
with:
node-version: '14.x'
- name: Install dependencies & Generate static files
run: |
node -v
npm i -g hexo-cli
npm i
hexo clean
hexo g
- name: Deploy to Github Pages
env:
REPO: github.com/lsgxs2019/lsgxs2019.github.io
GH_TOKEN: ${{ secrets.DEPLOY_KEY }}
run: |
cd ./public && git init && git add .
git config --global user.name "lsgxs2019"
git config --global user.email "lsgxs141@126.com"
git commit -m "Site deployed by GitHub Actions"
git push --force --quiet "https://$GH_TOKEN@$REPO" master:master